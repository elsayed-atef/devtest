# Define a path for the log file
$LogFilePath = "D:\data\logs\time_parsing_debug.log"

# Function to Log Messages with Timestamp and Log Level
function Log-Message {
    param (
        [string]$Level,
        [string]$Message
    )

    $timestamp = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
    $logEntry = "$timestamp [$Level] $Message"
    Write-Output $logEntry
    Add-Content -Path $LogFilePath -Value $logEntry
}

# Function to Test Time Parsing with Error Handling
function Test-TimeParsing {
    param (
        [string]$startTimeStr,
        [string]$endTimeStr
    )

    try {
        $startTime = [datetime]::ParseExact($startTimeStr, "HH:mm", $null).TimeOfDay
        Log-Message -Level "Info" -Message "Successfully parsed start time: $startTimeStr as $startTime"
    } catch {
        Log-Message -Level "Error" -Message "Failed to parse start time: $($_.Exception.Message). Start: $startTimeStr"
    }

    try {
        $endTime = [datetime]::ParseExact($endTimeStr, "HH:mm", $null).TimeOfDay
        Log-Message -Level "Info" -Message "Successfully parsed end time: $endTimeStr as $endTime"
    } catch {
        Log-Message -Level "Error" -Message "Failed to parse end time: $($_.Exception.Message). End: $endTimeStr"
    }
}

# Main Test Function
function Main {
    # Hardcoded time values for testing
    $testStartTime = "06:00"
    $testEndTime = "17:00"

    # Test Time Parsing
    Test-TimeParsing -startTimeStr $testStartTime -endTimeStr $testEndTime
}

# Run the main test function
Main
