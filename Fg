function Archive-Files {
    param (
        [string]$SourcePath,                  # The path to the directory to archive
        [string]$DestinationPath = "",        # The path to save the archive (optional)
        [bool]$Compress = $true,              # Whether to compress the files into a ZIP (default is true)
        [bool]$DeleteOriginal = $false        # Whether to delete original files after archiving (default is false)
    )

    # Validate the source path
    if (-not (Test-Path $SourcePath -PathType Container)) {
        throw "Source path '$SourcePath' does not exist or is not a directory."
    }

    # Set default destination path if not provided
    if (-not $DestinationPath) {
        $DestinationPath = Join-Path (Split-Path $SourcePath -Parent) "$(Split-Path $SourcePath -Leaf)_Archive"
    }

    # If compress is enabled, create a ZIP archive
    if ($Compress) {
        $zipFileName = "$DestinationPath.zip"
        if (Test-Path $zipFileName) {
            throw "Archive '$zipFileName' already exists. Please specify a different destination or move the existing archive."
        }
        # Use Compress-Archive to create the ZIP file
        Compress-Archive -Path $SourcePath\* -DestinationPath $zipFileName
        Write-Output "Files from '$SourcePath' have been archived to '$zipFileName'."
    } else {
        # If not compressing, simply copy the files to the destination directory
        if (-not (Test-Path $DestinationPath)) {
            New-Item -ItemType Directory -Path $DestinationPath | Out-Null
        }
        Copy-Item -Path $SourcePath\* -Destination $DestinationPath -Recurse
        Write-Output "Files from '$SourcePath' have been copied to '$DestinationPath'."
    }

    # Optionally delete original files
    if ($DeleteOriginal) {
        Remove-Item -Path $SourcePath\* -Recurse -Force
        Write-Output "Original files from '$SourcePath' have been deleted."
    }
}

# Example usage:
# Archive files from 'C:\temp\logs' to 'C:\archives\logs.zip' with compression and deletion of original files
Archive-Files -SourcePath "C:\temp\logs" -DestinationPath "C:\archives\logs.zip" -Compress $true -DeleteOriginal $true
